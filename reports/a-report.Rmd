---
title: "REPLACE ME"
output:
    html_document:
    df_print: paged
theme: sandstone
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
source(here::here("code/lib.R"))
theme_set(theme_bw())
```

```{r read}
atividade = read_csv(here::here("data/atividade-por-perfil-20190322.csv"), 
                    col_types = ("dcccccddddddddddddd")) 

```

## 1.  Qual o partido qual o partido mais assíduo  no twitter?

```{r}

ativos_2019 <- atividade %>% 
  filter(!is.na(twitter), seguidores != 0, segue != 0, engaj_mediano > 20, engaj_mediano_proprio > 20, engaj_total_retweet > 0)

agrupados_partido <- ativos_2019 %>%
  group_by(partido) %>% summarise(media = mean(engaj_mediano))

agrupados_partido %>%
    ggplot(aes(x = partido, y = media)) +
    geom_col()
  

```


##1. Quais os parlamentares mais populares (os mais seguidos) no twitter? 
  


```{r}

ativos_2019_seguidores <- atividade %>% 
  filter(!is.na(twitter), seguidores != 0, segue != 0, seguidores >= 200914)

ativos_2019_seguidores %>%
    ggplot(aes(x = nome_eleitoral, y = seguidores)) + coord_flip() +
    geom_col()

```

Usaremos apenas os parlamentares ativos em 2019 e para facilitar a visualização foram selecionados apenas aqueles que possuem mais de 200914 seguidores (os 15 mais seguidos). 
Observando o gráfico é possível saber facilmente qual o parlmentar mais popular, Romário, com  mais de 2500000 seguidores. Logo após vem José Serra e em seguida Flávio Bolsonaro. 



### 1.1 Os mais populares são também os mais ativos? 

```{r}
ativos_2019 %>%
    ggplot(aes(x = engaj_total, y = seguidores, colour=nome_eleitoral)) + 
    geom_point(aes(size = seguidores), alpha =.5, color="red")

```
Segundo o gráfico apresentado o parlamentar que mais possui seguidores é também um dos que menos tem engage dentro da rede, contudo o comportamento mais comum é um equilíbrio entre quantidade de seguidores e engajamento. 


### 1.2 Então quem são os mais populares? São os que mais produzem conteúdo próprio? 
```{r}
ativos_2019 %>% 
  ggplot(aes(x = seguidores, y = n_proprio, group=engaj_total_proprio)) +geom_point(aes(size = engaj_total_proprio), alpha =.5, color="blue")


```



## 4. Qual partido que possui mais parlamentares ativos ? (possuem twitter)

```{r}

partidos_assiduos <- ativos_2019 %>% 
 group_by(partido) %>% summarise(count=n()) %>% inner_join(ativos_2019, by='partido')


ggplot(partidos_assiduos, aes(x = partido, y = count)) +    
     geom_jitter(width = 1, size = 4, alpha = .7, height = 1, aes(colour = partido))
```



## 6. Quais os estados que têm maior engajamento no twitter?
```{r}

agrupados_partido <- ativos_2019 %>%
  group_by(UF) %>% summarise(media = mean(engaj_mediano))

agrupados_partido %>%
    ggplot(aes(x = UF, y = media)) +
    geom_col()
  

```

